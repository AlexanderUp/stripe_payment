{% extends "api/base_api.html" %}
{% block title %}{{ item.name }} detail API{% endblock %}
{% block content %}

<h1>Item: {{ item.name }}</h1>
<p>Description: {{ item.description }}</p>
<p>Price per unit: {{ item.price }}</p>
<button id="buy-button">Buy</button>
<script type="text/javascript">
    var stripe = Stripe({{ stripe_object }});
    var buyButton = document.getElementById('buy-button');
    buyButton.addEventListener('click', function() {
    // Create a new Checkout Session using the server-side endpoint 
    // Redirect to Stripe Session Checkout
    fetch('/buy/1', {method: 'GET'})
    .then(response => {return response.json()})
    .then(session => stripe.redirectToCheckout({ sessionId: session.id }))
    });
</script>

{% endblock %}